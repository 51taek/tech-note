## 시간 차원의 모델링

도메인 모델 패턴을 구현하는 고도화된 방법

---

### 이벤트 소싱 도메인 모델

이벤트 소싱 도메인 모델은 **이벤트 소싱(Event Sourcing) 패턴**을 사용하여 애그리게이트 상태를 관리한다.

즉, 애그리게이트의 상태 자체를 저장하는 대신  
**상태 변화(변경사항)를 나타내는 도메인 이벤트를 순서대로 저장하고**,  
필요할 때 이 이벤트들을 재생(replay)하여 애그리게이트 상태를 복원한다.

> 애그리게이트의 모든 변경은 반드시 이벤트로 표현되고 저장되어야 한다.

---

### 장점

- **과거 상태 재구성 가능**  
  애그리게이트의 모든 과거 상태를 언제든 재생성할 수 있다.

- **다양한 프로젝션 생성 가능**  
  기존 이벤트 스트림을 기반으로 새로운 읽기 모델(Projection)을 자유롭게 만들 수 있다.

- **감사 로그(audit log)로 완벽함**  
  이벤트는 변경 불가능한 기록이므로, 상태 변화 이력을 강력하게 추적할 수 있다.

- **정합성 검증 가능**  
  이벤트 스토어에 동시에 기록된 이벤트를 기반으로, 새로운 이벤트가 기존 이벤트와 충돌하는지 감지할 수 있다.

---

### 단점

- **러닝 커브가 있음**  
  상태 대신 이벤트 중심으로 사고하는 방식은 초반에 난이도가 높다.

- **이벤트 수정 불가 문제**  
  이벤트는 변경 불가(immutable)하기 때문에 이벤트 모델을 장기간 발전시키기가 까다롭다.  
  (이벤트 버저닝 필요)

- **아키텍처 복잡도 증가**  
  이벤트 스토어, 프로젝션, 이벤트 핸들러 등 여러 구성요소가 추가되어 전체 구조가 복잡해진다.

---

### 💡 참고

> 대부분의 시스템에서 애그리게이트당 **10,000개 이상의 이벤트가 쌓이면**  
> 이벤트 재생(replay)에 따른 성능 저하가 나타난다.  
> 그러나 현실의 대부분 시스템에서 **애그리게이트의 평균 이벤트 수명은 100개를 넘지 않는다.**
